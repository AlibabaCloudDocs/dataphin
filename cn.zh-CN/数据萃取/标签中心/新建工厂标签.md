---
keyword: 工厂标签
---

# 新建工厂标签

本文为您介绍如何新建工厂标签，帮助您完成行为偏好标签的创建。

完成行为规则的创建，详情请参见[新建行为规则](/cn.zh-CN/数据萃取/行为中心/新建行为规则.md)。

## 新建基础指标

1.  登录[Dataphin控制台](https://dataphin.console.aliyun.com/workingArea)。

2.  在Dataphin控制台页面，选择工作区地域后，单击**进入Dataphin\>\>**。

3.  在Dataphin产品首页，单击**研发**，进入数据**开发**页面。

4.  将鼠标悬停在**开发**上，单击**萃取**，进入数据**萃取**页面。

5.  单击**标签中心**，进入**工厂标签**页面。

6.  您可以通过以下任何一种方式，进入**新建工厂标签**页面。

    -   单击**工厂标签**后的![faga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5667528951/p94448.png)图标。

        ![工厂标签新建--更多](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1601987951/p63815.png)

    -   单击项目名称后![项目后](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0701987951/p63182.png)图标，选择**标签中心** \> **工厂标签**。

        ![ddd](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1601987951/p77257.png)

    -   单击**工厂标签**下的![新建域](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0701987951/p63199.png)图标。

        ![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1601987951/p63817.png)

    -   在左侧导航栏中，单击**工厂标签对象列表**，进入萃取对象列表页页面。在**工厂标签**页签下，单击页面右上角的**新建标签**。

        ![工厂标签新建-列表页](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1601987951/p63824.png)

7.  在**新建工厂标签**对话框，根据提示配置参数。

    ![fagag](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3667528951/p94452.png)

    |参数|描述|
    |--|--|
    |标签英文名|填写**标签英文名**，例如`item_price_favor`。|
    |标签名称|填写**标签名称**，例如**最近30天商品价格偏好**。|
    |描述|填写对标签的简单描述。|
    |所属类目|选择所属标签类目。如果没有可选类目，创建类目，详情请参见[管理标签类目](/cn.zh-CN/数据萃取/标签中心/管理标签类目.md)。|
    |公开状态|选择标签的**公开状态**，系统支持**公开**和**隐藏**。|
    |结果表名|填写输出表名，例如`item_price_favor`。|

8.  完成参数配置后，单击**确定**。


## 配置数据来源及标签值

1.  在**新建标签**页面，单击**数据来源及标签配置**下方的**开始配置**，进入数据来源配置页面。

    ![配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3667528951/p94464.png)

2.  根据**数据来源配置**页面提示配置参数。

    ![配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6667528951/p94468.png)

    |参数|描述|
    |--|--|
    |按行为域筛选|选择行为域，例如选择**电商**。|
    |按动作对象筛选|选择对象，选择**购买-商品**。|
    |按共有对象属性筛选|如果已选行为数据有共有对象属性，则还可以对共有对象属性设置筛选规则以进一步筛选需要的来源数据，最多选择3个共有对象属性。|
    |数据来源-时间跨度|Dataphin将基于所选时间跨度内的行为数据进行后续计算以生成最终标签。系统支持选择**30天**、**60天**、**90天**、**180天**、**365天**。|

3.  完成参数配置后，单击**下一步**。

4.  根据**标签值配置**页面提示配置参数。

    ![标签值](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4667528951/p94479.png)

    |参数|描述|
    |--|--|
    |打标方式|选择打标方式。系统支持**直接打标**和**对象属性映射打标**，详细说明如下：     -   **直接打标**：将筛选出来的行为，根据输入的标签值统一打标。

如果选择了**直接打标**，则需在**标签值定义**后的输入框中，输入预期返回的标签值。

![faga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2601987951/p95297.png)

    -   **对象属性映射打标**：基于行为的属性，把属性值直接映射为标签值或根据属性设置映射规则生成不同的标签值，可以一次实现对不同属性的行为打上不同的标签。

如果选择了**对象属性映射打标**，则需选择**共有对象属性**和**选择映射方式**。 |
    |共有对象属性|如果**打标方式**为**对象属性映射打标**，则需选择生成标签的对象属性，例如**商品价格**。|
    |选择映射方式|如果**打标方式**为**对象属性映射打标**，则需选择行为规则的数据映射生产标签的方式。系统支持**属性值应用为标签值**和**设计映射规则**，详细说明如下：     -   **属性值应用为标签值**：属性值直接映射为标签值。

例如，属性值商品类目直接生成为标签值。

    -   **设计映射规则**：根据属性设置映射规则生成不同的标签值。

例如，设计的映射规则如下：

        -   价格**小于200**的标签值为**低价格**。
        -   价格**小于500**的标签值为**中价格**。
        -   **剩余所有**价格的标签值为**高价格**。
系统会按照设定的规则顺序逐一匹配生效，如果匹配成功，则不再执行匹配操作。根据上述设定的规则匹配后的效果如下：

        -   `price<200`，标签值为低价格。
        -   `200≤price<500`，标签值为中价格。
        -   `500≤price`，标签值为高价格。 |

5.  单击**标签生成规则配置**。

6.  根据**标签生成规则配置**页面提示配置参数。

    ![标签](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6667528951/p94485.png)

    |参数|描述|
    |--|--|
    |返回标签值个数|定义每个ID最多能返回的标签值个数。每个ID可能对应多条行为数据，因此可能对应多个标签值，按照设置个数优先返回偏好度较大的标签值（标签值偏好度可在标签结果表查看）。|
    |选择衰减时间周期|不同时间的行为对标签值的影响程度不同。同一周期内行为的影响力相同，不同周期行为的影响力按照设置的衰减周期和曲线随时间递减。对于标签值会随着行为快速变化的，建议选择较短的时间周期（例如如纸尿裤型号偏好）。对于标签值相对稳定，不随行为快速变化的，建议选择较长的时间周期（例如预测个人肤质）。|
    |请选择衰减时间曲线|支持对所选数据来源-时间跨度（例如90天）行为数据，根据不同时间周期（如7天）切片（90/7=13个片段）设置衰减模式，不同时间周期行为数据标签值的影响力与您选择的衰减模式相关。例如，个人肤质是长期稳定的，因此一个消费者7天前收藏美妆商品的行为和最近7天收藏美妆商品的行为，对刻画这个消费者的护肤品功效偏好无影响，则选择衰减模式为平滑型。|
    |标签生成规则-行为权重分配|基于业务上的判断对多个行为进行权重分配，要求最多两位小数，且各项权重和为1。权重越大，表示该行为对最后标签值的影响越大。|
    |标签生成规则-覆盖用户范围|覆盖用户百分比和覆盖用户范围的详细说明如下：     -   覆盖用户百分比：行为发生次数在某个值以下的用户数量占所有用户数量的百分比。例如，购买保湿类护肤品次数在3次以下的用户数量占所有购买保湿类护肤品用户数量的10%。
    -   覆盖用户范围：限制用户打标的范围，防止行为发生次数过少或过多影响数据分析的准确度。

        -   如果没有设置覆盖用户范围，则所有的行为记录都会参与计算。
        -   如果设置了覆盖用户范围，则会按照设定的百分比过滤掉部分用户的行为记录。
例如，行为为购买保湿类护肤品，10%的用户购买次数在3次以下，90%的用户购买次数在100次以下。如果选择范围为10%-90%，则只对购买次数在3次以上100次以下的用户打标，防止购买次数过少（3次以下）或过多（100次以上）影响数据分析的准确度。 |

7.  完成配置后，单击**确定**。


## 配置存储

1.  在顶部菜单栏，单击**物理化配置**。

2.  根据**物理化配置**页面提示，配置参数。

    ![faga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2601987951/p95298.png)

    |参数|描述|
    |--|--|
    |存储生命周期|选择标签的**存储生命周期**。系统提供的**90天**、**180天**、**365天**和**3650天**。|
    |选择分区字段|选择标签输出表的分区。|

3.  配置完成后，单击**确认**。

4.  保存、测试并提交标签。

    1.  单击页面右上方的![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6667528951/p61786.png)图标，保存当前标签的配置。

    2.  单击页面右上方的![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6667528951/p61787.png)图标，测试运行标签。

    3.  单击页面右上方的![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6667528951/p61789.png)图标，完成偏好标签的提交，提交后的偏好标签会自动生成日调度的周期任务。

    4.  在**提交备注**对话框，填写备注信息。

    5.  单击**确定并提交**。


**说明：** 提交后的标签需进行补数据操作，以获取所选时间跨度内的历史行为数据作为来源数据。如果您未进行补数据操作，则标签结果表数据可能为空。

