---
keyword: 新建API
---

# 新建API

在您调用API前，需要完成API的创建并发布至生产环境。Dataphin系统支持通过界面化和SQL语句的方式，配置服务单元字段即查询条件生成API。本文为您介绍如何新建API。

完成服务单元分组的创建，请参见[新建服务单元分组](/cn.zh-CN/数据服务/消费API/开发API/新建分组.md)。

自定义SQL模式支持通过脚本模式为服务单元配置复杂查询条件及简单函数，生成API。

模板向导模式支持通过界面化配置服务单元的字段及相应查询条件，生成API，操作简单且易上手。

## 使用限制

系统支持超级管理源和开发用户角色的成员新建API。更多关于API的操作限制，请参见[数据服务权限列表](/cn.zh-CN/权限管理/数据服务权限列表.md)。

## 通过模板向导模式新建API

1.  [进入个人工作台](/cn.zh-CN/数据服务/进入数据服务.md)。

2.  在**个人后台**页面，单击左侧导航栏**服务开发**下的**API**。

3.  在**API**页面，单击**新建API**。

4.  选择API创建方式。

    1.  在**API创建方式选择**页面，选择**模板向导模式**。

    2.  单击**下一步**。

5.  配置API基础信息。

    1.  在**API基础信息配置**页面，配置参数。

        ![gaga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p84949.png)

        |参数|描述|
        |--|--|
        |**API名称**|填写API名称。API名称由汉字、英文、数字或下划线（\_）组合组成。API名称的限制如下：        -   API名称的长度范围为4~42个字符。
        -   API名称仅支持以英文字母开头。
        -   系统内API名称不允许重复。 |
        |**请求方式**|选择API的请求方式。|
        |**数据更新频率**|选择API同步数据的频率。|
        |**描述**|填写简单描述。|
        |**协议**|选择API同步数据的协议。**说明：** 完成SSL证书的配置，避免无法正常调用。 |

    2.  单击**下一步**。

6.  配置参数。

    1.  在**参数配置**页面，配置参数。

        ![test](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4088496951/p139698.png)

        |区域|参数|描述|
        |--|--|--|
        |**参数配置**|**服务单元分组配置**|系统支持选择多物理表服务单元、单物理表服务单元和Dataphin逻辑表：        -   选择单物理表和多物理表服务单元：
            1.  单击**服务单元类型**显示框区域内，在下拉列表中选择服务单元类型。
            2.  单击**服务单元分组**显示框区域内，在下拉列表中选择服务单元分组。
            3.  单击**服务单元模式**显示框区域内，在下拉列表中选择服务单元模式。
            4.  单击**服务单元**显示框区域内，在下拉列表中选择服务单元。
        -   添加Dataphin逻辑表：
            1.  单击**服务单元类型**显示框区域内，在下拉列表中选择Dataphin逻辑表。
            2.  单击**模式**显示框区域内，在下拉列表中选择数据开发的模式。
            3.  单击**业务板块**显示框区域内，在下拉列表中选择对应开发模式下的业务板块。
            4.  单击**数据表**显示框区域内，在下拉列表中选择数据表。 |
        |**服务单元字段**|为您展示该服务单元的字段。您也可以单击**数据预览**，查看服务单元的数据。|
        |**请求参数**选中**服务单元字段**区域的字段后，单击上方的![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5811987951/p68171.png)图标，同步字段信息至右侧的**请求参数**区域。

选中**请求参数**区域的字段后，单击下方的![test](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4088496951/p139696.png)图标，删除**请求参数**区域的参数。

|**参数名**|**参数名**由字母、数字或下划线（\_）组合组成。**说明：** **参数名**不能超过64个字符。 |
        |**参数类型**|选择参数的类型。|
        |**操作符**|选择参数的操作符。|
        |**示例**|填写参数示例。**说明：** **示例**不能超过20个字符。 |
        |**描述**|填写参数的描述。**说明：** **描述**不能超过50个字符。 |
        |**是否必填**|选择参数是否为必填参数。|
        |**返回参数**选中**服务单元字段**区域的字段后，单击下方的![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5811987951/p68171.png)图标，同步字段信息至右侧的**返回参数**区域。

选中**返回参数**区域的字段后，单击下方的![test](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4088496951/p139696.png)图标，删除**返回参数**区域的参数。

|**参数名**|**参数名**由字母、数字或下划线（\_）组合组成。**说明：** **参数名**不能超过64个字符。 |
        |**参数类型**|选择参数的类型。|
        |**示例**|填写参数示例。**说明：** **示例**不能超过20个字符。 |
        |**描述**|填写参数的描述。**说明：** **描述**不能超过50个字符。 |

    2.  单击**提交**，提交API至开发环境。


## 通过自定义SQL模式新建API

1.  [进入个人工作台](/cn.zh-CN/数据服务/进入数据服务.md)。

2.  在**个人后台**页面，单击左侧导航栏**服务开发**下的**API**。

3.  在**API**页面，单击页面右上角的**新建API**。

4.  在**新建API**配置向导页面，完成以下操作。

    1.  选择API的创建方式。

        1.  API的创建方式选择为**自定义SQL模式**。
        2.  单击**下一步**。
    2.  配置API基础信息。

        1.  配置参数。

            ![gaga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p84949.png)

            |参数|描述|
            |--|--|
            |**API名称**|**API名称**由汉字、英文、数字或下划线（\_）组合组成。|
            |**请求方式**|**请求方式**包括：             -   **GET**
            -   **LIST** |
            |**数据更新频率**|**数据更新频率**包括：             -   **每天**
            -   **每小时**
            -   **每分钟** |
            |**描述**|填写对API简单的描述。|
            |**协议**|选择通过API同步数据的协议。**协议**包括：             -   **HTTP**
            -   **HTTPS** |

        2.  单击**下一步**。
    3.  配置参数。

        1.  在**参数配置**页面，配置参数。

            ![GAGAGA](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p85394.png)

            |编号|参数|描述|
            |--|--|--|
            |①|**API SQL脚本编辑**|在**API SQL脚本编辑**框中输入SQL语句。 您可以将鼠标悬停至![gaga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p85395.png)图标，查看SQL脚本的限制。|
            |②|**服务单元**|系统支持选择多物理表服务单元、单物理表服务单元和Dataphin逻辑表：            -   选择单物理表和多物理表服务单元：
                1.  单击**服务单元类型**显示框区域内，在下拉列表中选择服务单元类型。
                2.  单击**服务单元分组**显示框区域内，在下拉列表中选择服务单元分组。
                3.  单击**服务单元模式**显示框区域内，在下拉列表中选择服务单元模式。
                4.  单击**服务单元**显示框区域内，在下拉列表中选择服务单元。
            -   添加Dataphin逻辑表：
                1.  单击**服务单元类型**显示框区域内，在下拉列表中选择Dataphin逻辑表。
                2.  单击**模式**显示框区域内，在下拉列表中选择数据开发的模式。
                3.  单击**业务板块**显示框区域内，在下拉列表中选择对应开发模式下的业务板块。
                4.  单击**数据表**显示框区域内，在下拉列表中选择数据表。 |
            |③|**数据预览**|单击**数据预览**，查看服务单元或逻辑表中的数据。![fagaga](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p85396.png)

您也可以修改**返回条数**后，单击**刷新数据预览**后，查看数据。 |
            |④|**SQL试运行**|在您开始SQL试运行前，需要保证SQL代码语法正确。如果SQL代码语法不正确，则无法进入**请求参数输入**页面。

查看API SQL脚本的运行结果：             1.  单击**SQL试运行**。
            2.  在**请求参数输入**对话框中，**试运行输入值**输入为数据预览时获取的`user_id`的数据。

![fagag](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6811987951/p85397.png)

            3.  单击**确认**，即可开始SQL运行。
                -   如果**运行结果**返回**Success**，则SQL语法校验、引擎层校验、底层数据库引擎校验的结果为成功。
                -   如果**运行结果**返回**Error**，则SQL语法校验、引擎层校验、底层数据库引擎校验的结果为失败。 |
            |⑤|**解析参数**|单击**解析参数**后，系统根据**API SQL脚本编辑**处填写的SQL语句自动归类为**请求参数**和**返回参数**。|
            |⑥|**请求参数**|配置参数：             -   单击**参数类型**显示框区域内，在下拉列表中选择**参数类型**。
            -   在**示例**列下的输入框中，输入示例。
            -   在**描述**列下的输入框中，输入描述。
            -   选择参数为**是否必填**。 |
            |⑦|**返回参数**|配置参数：             -   单击**参数类型**显示框区域内，在下拉列表中选择**参数类型**。
            -   在**示例**列下的输入框中，输入示例。
            -   在**描述**列下的输入框中，输入描述。 |

        2.  单击**提交**，提交后的API即可进入开发环境。

